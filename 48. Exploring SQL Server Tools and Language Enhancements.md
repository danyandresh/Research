# Exploring SQL Server Tools and Language Enhancements

## TVP

- Process a set of rows as a single entity
  - Select or join against a TVP
  - Similar to temp tables, table variables, and CTEs
- Populate a TVP and then pass it around
  - It's a single parameter
  - Pass from procedure to procedure on the server
  - Pass from client to server  across the network
- Based on user-defined table types
  - Defines the schema, just like an ordinary table
  - Simply declare a variable as the type to get a TVP
- Stored in tempdb
  - Created and destroyed automatically behind the scenes
  - Can be indexed

```SQL
CREATE TYPE OrderUdt AS TABLE(
  OrderId int,
  CustomerId int
)

CREATE PROCEDURE uspInsertNewOrder(
  @OrderHeader AS OrderUdt READONLY)
AS
BEGIN

```

- `SqlDbTypes.Structured`
- Set the type name to the user defined table type in SQL Server


### TVP Limitations

- TVPs are readonly
  - OUTPUT keyword cannot be used
  - no UPDATE INSERT or DELETE
- No ALTER TABLE as TYPE
- Statistics are not maintained on TVPs
